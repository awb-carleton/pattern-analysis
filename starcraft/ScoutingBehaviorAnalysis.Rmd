---
title: "Scouting Behavior Analysis"
author: "Alison Cameron"
date: "July 2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(ggplot2)
library(dplyr)
```

### Reading Data and Gathering Summary Statistics
```{r}
scouting <- read.csv("scouting_stats.csv")
summary(scouting)
scouting$Win2 <- ifelse(scouting$Win == 1, "win", "loss")
```


### Exploratory Data Analysis
```{r}
ggplot(scouting, aes(y=ScoutingFrequency, group=Win)) + geom_boxplot()
ggplot(scouting, aes(y=ScoutingTime, group=Win)) + geom_boxplot()
ggplot(scouting, aes(x = Win, y = ScoutingTime, color = Win2, shape = Win2)) + geom_point()
ggplot(scouting, aes(x = Win, y = ScoutingFrequency, color = Win2, shape = Win2)) + geom_point()
ggplot(scouting, aes(x = APM, y = ScoutingFrequency, color = Win2, shape = Win2)) + geom_point()
ggplot(scouting, aes(x = APM, y = ScoutingTime, color = Win2, shape = Win2)) + geom_point()
ggplot(scouting, aes(x = ScoutingFrequency, y = ScoutingTime, color = Win2, shape = Win2)) + geom_point()
```

### Creating a Binary Logistic Regression Model
```{r}
scouting.glm <- glm(Win ~ (ScoutingTime + ScoutingFrequency + APM)^2, data = scouting, family = binomial)
summary(scouting.glm)
anova(scouting.glm, test = "Chisq")
```

Removing ScoutingFrequency and its interaction terms since they contribute the least to 
the residual deviance
```{r}
scouting.glm2 <- update(scouting.glm, . ~ . -ScoutingFrequency - ScoutingFrequency:APM - ScoutingTime:ScoutingFrequency)
summary(scouting.glm2)
anova(scouting.glm2, scouting.glm, test = "Chisq")
```

ANOVA table indicates that the larger model is preferred, so we accept the original model (If an interaction term is included, the individual variables must also be included)

### Interpretation
```{r}
timeOdds <- exp(9.172*log(1.1))
frequencyOdds <- exp(71.24*log(1.1))
APModds <- exp(0.001157*log(1.1))
timeOdds
frequencyOdds
APModds
```

For a 10% increase in the time spent scouting an opponent, the odds that a player will win
increases by a factor of 2.396




